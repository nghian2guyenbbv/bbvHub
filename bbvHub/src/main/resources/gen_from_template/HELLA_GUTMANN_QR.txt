-------customer CUST_NUMBER---------
DELETE FROM USER_VEHICLE_HISTORY WHERE USER_ID IN (select ID FROM ESHOP_USER WHERE FIRST_NAME = 'CUST_NUMBER');
DELETE FROM LOGIN WHERE USER_ID IN (select ID FROM ESHOP_USER WHERE FIRST_NAME = 'CUST_NUMBER');
DELETE FROM GROUP_USER WHERE USER_ID IN (select ID FROM ESHOP_USER WHERE FIRST_NAME = 'CUST_NUMBER');
DELETE FROM GROUP_USER WHERE GROUP_ID IN (SELECT ID FROM ESHOP_GROUP
                                          WHERE NAME ='CUSTOMER_CUST_NUMBER_USER_ADMIN');
DELETE FROM ESHOP_USER WHERE  FIRST_NAME = 'CUST_NUMBER';
DELETE FROM ESHOP_USER WHERE USERNAME = 'Agent-CUST_NUMBER';
DELETE FROM ORGANISATION_ADDRESS WHERE ORGANISATION_ID IN (SELECT ID FROM ORGANISATION WHERE ORG_CODE = 'CUST_NUMBER');
DELETE FROM GROUP_ROLE WHERE GROUP_ID IN (SELECT id from ESHOP_GROUP where name ='CUSTOMER_CUST_NUMBER_USER_ADMIN');
DELETE FROM ORGANISATION_GROUP WHERE GROUP_ID IN (SELECT id from ESHOP_GROUP where name ='CUSTOMER_CUST_NUMBER_USER_ADMIN');
DELETE FROM COLLECTION_RELATION WHERE ORGANISATION_ID IN (SELECT ID FROM ORGANISATION WHERE ORG_CODE = 'CUST_NUMBER');
DELETE FROM ORGANISATION WHERE ORG_CODE = 'CUST_NUMBER';
DELETE FROM ESHOP_GROUP WHERE NAME ='CUSTOMER_CUST_NUMBER_USER_ADMIN';
IF (SELECT COUNT(ID)  from ORGANISATION WHERE ORG_CODE = 'CUST_NUMBER') = 0
BEGIN
INSERT INTO CUSTOMER_SETTINGS(ALLOCATION_ID, PAYMENT_METHOD, DELIVERY_ID, COLLECTIVE_DELIVERY_ID, NET_PRICE_VIEW, NET_PRICE_CONFIRM, VIEW_BILLING, ADDRESS_ID, USE_DEFAULT_SETTING, EMAIL_NOTIFICATION_ORDER, BILLING_ADDRESS_ID, DELIVERY_ADDRESS_ID, ALLOW_NET_PRICE_CHANGED, INVOICE_TYPE, SHOW_DISCOUNT, SESSION_TIMEOUT_SECONDS, SHOW_OCI_VAT, HOME_BRANCH, DEMO_CUSTOMER, PRICE_DISPLAY_ID, NORMAUTO_DISPLAY, HAS_PARTNER_PROGRAM_VIEW, WSS_SHOW_NET_PRICE, WSS_MARGIN_GROUP, WSS_DELIVERY_PROFILE_ID, WSS_DELIVERY_ID)VALUES(1, 2, 2, 1, 1, 1, 0, 0, 0, 0, N'1', N'1', 1, 2, 0, 14400, 0, NULL, 0, 1, 0, 0, 0, NULL, NULL, 1);
SET @cust_setting = @@IDENTITY;
INSERT INTO ORGANISATION
(NAME, ORG_CODE, ORGTYPE_ID, PARENT_ID, DESCRIPTION, SHORTNAME, ORDER_SETTINGS_ID)
VALUES(N'CUST_NAME', N'CUST_NUMBER', @org_type, @hella_gutmann_org, N'', N'customer-CUST_NUMBER', @cust_setting);
SET @org_id = @@IDENTITY;
INSERT INTO COLLECTION_RELATION
(COLLECTION_ID, ORGANISATION_ID, IS_ACTIVE)
VALUES(@hella_gutmann_collection, @org_id, 1);
INSERT INTO ADDRESS
(LINE1, LINE2, LINE3, COUNTRYISO, STATE, CITY, ZIPCODE, ADDRESS_TYPE_ID)
VALUES(N'CUST_LINE1', NULL, NULL, N'CUST_COUNTRYISO', NULL, N'CUST_CITY', N'CUST_ZIPCODE', 1);
SET @address_id = @@IDENTITY;

INSERT INTO ORGANISATION_ADDRESS
(ORGANISATION_ID, ADDRESS_ID)
VALUES(@org_id, @address_id);
INSERT INTO ESHOP_GROUP
(NAME, DESCRIPTION)
VALUES(N'CUSTOMER_CUST_NUMBER_USER_ADMIN', N'User admin group of ');
SET @admin_group_id = @@IDENTITY;
INSERT INTO GROUP_ROLE
(GROUP_ID, ROLE_ID)
VALUES(@admin_group_id, @admin_role);

INSERT INTO ORGANISATION_GROUP
(GROUP_ID, ORGANISATION_ID)
VALUES(@admin_group_id, @org_id)
END;

IF (SELECT COUNT(ID)  from ESHOP_USER WHERE USERNAME = N'Agent-CUST_NUMBER') = 0
BEGIN
INSERT INTO USER_SETTINGS
(ALLOCATION_ID, PAYMENT_METHOD, DELIVERY_ID, COLLECTIVE_DELIVERY_ID, NET_PRICE_VIEW, NET_PRICE_CONFIRM, VIEW_BILLING, ADDRESS_ID, USE_DEFAULT_SETTING, EMAIL_NOTIFICATION_ORDER, BILLING_ADDRESS_ID, DELIVERY_ADDRESS_ID, INVOICE_TYPE, SHOW_DISCOUNT, SHOW_HAPPY_POINTS, ACCEPT_HAPPY_POINT_TERM, SALE_ON_BEHALF_OF, SHOW_RECOMMENDED_RETAIL_PRICE, CURRENT_STATE_NET_PRICE_VIEW, CLASSIC_CATEGORY_VIEW, SINGLE_SELECT_MODE)VALUES(1, 2, 2, 1, 1, 1, 0, 0, 1, 0, N'1', N'1', 2, 0, 0, 0, 1, 0, 1, 0, 0);
SET @user_setting = @@IDENTITY;
INSERT INTO ESHOP_USER
(SALUTATION, FIRST_NAME, LAST_NAME, EMAIL, USERNAME, PHONE, [LANGUAGE], [TYPE], HOURLY_RATE, EMAIL_CONFIRMATION, NEWSLETTER, SETTING, VAT_CONFIRM, SIGN_IN_DATE, FAX, ORIGINAL_USER_ID)
VALUES(9, N'CUST_NUMBER', N'Agent', N'CUST_EMAIL', N'Agent-CUST_NUMBER', N'CUST_PHONE', 1, N'ON_BEHALF_ADMIN', NULL, 0, 0, @user_setting, 1, NULL, NULL, NULL);
SET @user_id = @@IDENTITY;
SET @admin_group_id = (SELECT ID FROM ESHOP_GROUP
WHERE NAME ='CUSTOMER_CUST_NUMBER_USER_ADMIN');
INSERT INTO GROUP_USER
(GROUP_ID, USER_ID)
VALUES(@admin_group_id, @user_id)
END;

INSERT INTO LOGIN (PASSWORD, USER_ID, IS_USER_ACTIVE, hash_type, LAST_ON_BEHALF_OF_DATE, FIRST_LOGIN_DATE, PASSWORD_HASH, PASSWORD_SALT) SELECT 'FdcFONWLNYYKY', ID , 1, 'BLCK_VAR', '', '', '', '' FROM ESHOP_USER WHERE USERNAME = 'Agent-CUST_NUMBER';